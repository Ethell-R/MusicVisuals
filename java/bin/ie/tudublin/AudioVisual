package ie.tudublin;

import ddf.minim.*;
import processing.core.*;

public class AudioVisual extends PApplet
{
    Minim minim;
    AudioPlayer player;
    FFT fft;

    public void settings()
    {
        size(1024, 600, P3D);
    }

    public void setup()
    {
        minim = new Minim(this);
        player = minim.loadFile("ParasiteEve.mp3", 1024);
        player.play();
        fft = new FFT(player.bufferSize(), player.sampleRate());
    }

    public void draw()
    {
        background(0);
        fft.forward(player.mix);

        noFill();
        stroke(255);
        float bandWidth = (float)width / fft.specSize();
        for(int i = 0 ; i < fft.specSize() ; i ++)
        {
            float x = i * bandWidth;
            float y = height;
            float h = -height + map(fft.getBand(i), 0, 255, height, 0);
            rect(x, y, bandWidth, h);
        }
    }

    public void stop()
    {
        player.close();
        minim.stop();
        super.stop();
    }
}
